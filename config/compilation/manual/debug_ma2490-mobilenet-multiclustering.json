{
    "initialize": {
        "Singular": [
            {
                "name" : "GlobalConfigParams",
                "_comment" : "Stores common params accross multiple passes. Access through the Computation Model.",
                "recorded_model": true,
                "log_time" : true,
                "verbose": "Debug",
                "weights_form": "None",
                "barrier_index_assignment" : "Dynamic",
                "Number_of_DPUs" : 20,
                "Number_of_Clusters" : 4,
                "UpaShaves": 1,
                "DDRScratch": 31457280,
                "MemoryHack": false,
                "CMX_memory_overflow_safety_factor" : 0.925,
                "cmx": 917504,
                "split_strategy" :
                [

                    {   "name_filter":".*input#.*",
                        "strategy": "SplitOverHOverlapped"
                    },
                    {
                        "name_filter":".*Conv/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv/depthwise/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_1/expand/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_1/depthwise/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_1/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_2/depthwise/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_2/depthwise/Relu6_1#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_2/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_2/add/Add#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_3/expand/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_3/depthwise/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_3/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_4/expand/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_4/depthwise/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_4/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_4/add/Add#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_5/expand/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_5/depthwise/Relu6#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_5/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverH"
                    },
                    {
                        "name_filter":".*expanded_conv_5/add/Add#.*",
                        "strategy": "HKSwitch"
                    },
                    {
                        "name_filter":".*expanded_conv_6/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_6/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_6/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_7/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_7/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_7/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_7/add/Add#.*",
                        "strategy": "Clustering"
                    },
                    {
                        "name_filter":".*expanded_conv_8/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_8/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_8/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_8/add/Add#.*",
                        "strategy": "Clustering"
                    },
                    {
                        "name_filter":".*expanded_conv_9/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_9/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_9/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_9/add/Add#.*",
                        "strategy": "Clustering"
                    },
                    {
                        "name_filter":".*expanded_conv_10/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_10/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_10/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_11/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_11/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_11/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_11/add/Add#.*",
                        "strategy": "Clustering"
                    },
                    {
                        "name_filter":".*expanded_conv_12/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_12/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_12/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_12/add/Add#.*",
                        "strategy": "Clustering"
                    },
                    {
                        "name_filter":".*expanded_conv_13/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_13/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_13/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_14/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_14/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_14/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_14/add/Add#.*",
                        "strategy": "Clustering"
                    },
                    {
                        "name_filter":".*expanded_conv_15/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_15/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_15/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_15/add/Add#.*",
                        "strategy": "Clustering"
                    },
                    {
                        "name_filter":".*expanded_conv_16/expand/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_16/depthwise/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*expanded_conv_16/project/BatchNorm/FusedBatchNorm/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*Conv_1/Relu6#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*Logits/AvgPool/AvgPool#.*",
                        "strategy": "SplitOverK"
                    },
                    {
                        "name_filter":".*Logits/Conv2d_1c_1x1/BiasAdd/Logits/Conv2d_1c_1x1/BiasAdd#.*",
                        "strategy": "SplitOverK"
                    }
                ],
                "sparsity_strategy" :
                [
                    {
                        "name_filter": ".*",
                        "outputActivationSparsity": true,
                        "inputActivationSparsity": true,
                        "weightsSparsity": true
                    }
                ],
                "default_tensor_placement" : "NNCMX"
            },
            "ComputeMemory",
            "AssignUniqueOpId",
            {
                "name": "GenerateDot",
                "output": "output/dots/original_model.dot",
                "scope": "OpControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/original_model.dot"
            },
            {
                "name": "CreateSourceStructure",
                "VersionMajor": 3,
                "VersionMinor": 11,
                "VersionPatch": 0,
                "VersionHash": "9aa43159420c77d8cf765393954ac2fbb372ab02"
            },
            "StoreTensorPlacement",
            {
                "name": "GenerateDot",
                "output": "output/dots/StoreTensorPlacement.dot",
                "scope": "OpControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/StoreTensorPlacement.dot"
            }
        ]
    },
    "adapt": {
        "Singular": [
            "TensorsToFP16",
            "AverageAsDepthWise",
            "FuseBatchNorm",
            "FuseBias",
            "FuseRelu",
            "FuseScale",
            "FullyConnectedAsConv2D",
            {
                "name": "GenerateDot",
                "output": "output/dots/adapt_model.dot",
                "scope": "OpControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/adapt_model.dot"
            },
            "StoreLayerSplitStrategy",
            "StoreLayerSparsityStrategy",
            "StreamingTiling",
            "StreamBinaryDataWeights",
            {
                "name": "GenerateDot",
                "output": "output/dots/tiling_model.dot",
                "scope": "OpControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/tiling_model.dot"
            }
        ]
    },
    "keembay_adapt": {
        "Singular": [
            "ConcatAsImplicit",
            "StoreWorkloadStrategy",
            "ConvertOpsToDPUTasks",
            "ConvertOpsToUPATasks",
            "ForceSerialize",
            "KMBOrderConversion",
            "AlignTo16Channels",
            "AlignTaskWeights",
            "GenerateSparsityMapsPopulatedTensors",
            "GenerateWeightsTables",
            "GenerateEltWiseConstants",
            "StrategyLayersToTensors",
            "ComputeTensorsQuantParams",
            "UpdateImplicitLayersQuantizationParams",
            "PopulateWeightsTablesQuantization",
            "RemoveBiasTensors",
            "SplittingTensorsAcrossClusters",
            {
                "name": "GenerateDot",
                "output": "output/dots/keembay_adapt_model.dot",
                "scope": "OpControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/keembay_adapt_model.dot"
            }
        ]
    },
    "dma": {
        "Singular" : [
            "SetDpuTasksMemoryLocation",
            "SetUPATasksMemoryLocation",
            {
                "name": "GenerateDot",
                "output": "output/dots/dpu_tasks_location.dot",
                "scope": "OpControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/dpu_tasks_location.dot"
            },
            "ResolveImplicitOperations",
            {
                "name": "GenerateDot",
                "output": "output/dots/implicit_operations_model.dot",
                "scope": "OpControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/implicit_operations_model.dot"
            },
            "AddDPUTasksWeightsDMATasks",
            "AddUPATasksExtraInputsDMATasks",
            {
                "name": "GenerateDot",
                "output": "output/dots/dma_model.dot",
                "scope": "OpControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/dma_model.dot"
            },
            "GenerateSparsityMapsUnpopulatedTensors"

        ]
    },
    "control_flows":{
        "Singular" : [
            "TaskControlFlows",
            {
                "name": "GenerateDot",
                "output": "output/dots/TaskControlFlows_model.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/TaskControlFlows_model.dot"
            },
            "TransitiveReduction",
            "LayerNumbering",
            {
                "name": "GenerateDot",
                "output": "output/dots/TaskControlFlows_model_transitive_reduction.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/TaskControlFlows_model_transitive_reduction.dot"
            },
            "HangingDmaControlFlows",
            "TransitiveReduction",
            "LayerNumbering",
            {
                "name": "GenerateDot",
                "output": "output/dots/NoHangingDmas.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/NoHangingDmas.dot"
            },
            "NNCMX2DDRControlFlows",
            "TransitiveReduction",
            {
                "name": "GenerateDot",
                "output": "output/dots/NNCMX2DDRControlFlows.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/cmx2DDRControlFlows.dot"
            }
        ]
    },
    "finalize": {
        "Singular": [
            "AddDeallocationTasks",
            {
                "name": "GenerateDot",
                "output": "output/dots/deallocation_model.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/deallocation_model.dot"
            },
            {
                "name": "TransitiveReduction",
                "filter": "MemoryRequirement"
            },
            "MarkLastNodeForMaxTopologicalCut",
            {
                "name": "GenerateDot",
                "output": "output/dots/TransitiveReductionBeforeMaxCut.dot",
                "scope": "ControlModel",
                "content": "nonfull",
                "html": true
            },
            {
                "name": "GenerateDot",
                "output": "output/dots/TransitiveReductionBeforeMaxCutFull.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/TransitiveReductionBeforeMaxCut.dot"
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/TransitiveReductionBeforeMaxCutFull.dot"
            },
            "MaxTopologicalCutAndPartialSerialisation",
            {
                "name": "GenerateDot",
                "output": "output/dots/MaxTopologicalCutAndPartialSerialisation.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            "TransitiveReduction",
            {
                "name": "GenerateDot",
                "output": "output/dots/TransitiveReductionAfterMaxCut.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/TransitiveReductionAfterMaxCut.dot"
            },
            {
                "name": "GenerateWorkloads",
                "costfunction": "greedy",
                "TensorSplitAlgorithms": "Rectangle, Z-Tiling",
                "_comment": "Supported CostFunctions are: balanced | criticalpath | minmax | greedy. Supported TensorSplitAlgorithms are Rectangle, Z-Tiling"
            },
            "ArrangeKeembayExecution",
            "AllocateInputOutputTensorsKeemBay",
            "AllocateGraphfileTensorsKeemBayLegacy",
            "ReAllocateImplicitOperationsKeemBay",
            "AllocateCMXTensorsKeemBay",
            {
                "name": "GenerateDot",
                "output": "output/dots/BeforeGraphColoring.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/BeforeGraphColoring.dot"
            },
            {
                "name": "GenerateDot",
                "output": "output/dots/BeforeGraphColoringControl.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/BeforeGraphColoringControl.dot"
            },
            {
                "name": "TensorGraphColoring",
                "cmxOutput": "output/dots/nnCmx.dot",
                "heapOutput": "output/dots/nnHeap.dot"
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/nnCmx.dot"
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/nnHeap.dot"
            },
            "RemoveDeallocationTasks",
            {
                "name": "GenerateDot",
                "output": "output/dots/DeallocationTasksRemoved.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/DeallocationTasksRemoved.dot"
            },
            "TransitiveReduction",
            {
                "name": "GenerateDot",
                "output": "output/dots/DeallocationTasksRemovedAndTransitiveReduction.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/DeallocationTasksRemovedAndTransitiveReduction.dot"
            },
            {
                "name" : "InsertBarrierTasks",
                "outputBIG": "output/dots/BarrierInterferenceGraph.dot",
                "barrier_reuse_window" : 0
            },
            {
                "name": "GenerateDot",
                "output": "output/dots/BarriersInserted.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/BarriersInserted.dot"
            },
            "TransitiveReduction",
            {
                "name": "GenerateDot",
                "output": "output/dots/BarriersInsertedTransitiveReductionApplied.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/BarriersInsertedTransitiveReductionApplied.dot"
            },
            "PopulateWeightsTablesPointers",
            {
                "name": "GenerateDot",
                "output": "output/dots/final_model.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/final_model.dot"
            }
        ]
    },
    "scheduling": {
        "Singular": [
            "StoreBarriersNamesInTasks",
            "GenerateExecutionSchedule",
            "BarrierIndexAssignment",
            "UpdateBarrierRefs",
            {
                "name": "GenerateDot",
                "output": "output/dots/serial_model.dot",
                "scope": "ControlModel",
                "content": "full",
                "html": true
            },
            {
                "name": "ConvertDot",
                "input": "output/dots/serial_model.dot"
            }
        ]
    },
    "validate": {
        "Singular": [
            "CheckTensors"
        ]
    },
    "serialize": {
        "Singular": [
            {
                "name": "GenerateBlobKeembay",
                "output": "output/mcm.blob"
            },
            {
                "name": "ConvertFlatbuffer",
                "input": "output/mcm.blob"
            }

        ]
    },
    "root": {
        "Singular": [
            "initialize",
            "validate",
            "adapt",
            "keembay_adapt",
            "dma",
            "control_flows",
            "finalize",
            "scheduling",
            "serialize"
        ]
    }
}
